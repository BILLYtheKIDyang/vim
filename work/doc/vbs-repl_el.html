<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>vbs-repl.el - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/navigation.js" defer></script>
<script src="./js/search.js" defer></script>
<script src="./js/search_index.js" defer></script>
<script src="./js/searcher.js" defer></script>
<script src="./js/darkfish.js" defer></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">




<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="./'.html">&#39;</a>
  
    <li><a href="./24_pl.html">24.pl</a>
  
    <li><a href="./4748_test.html">4748.test</a>
  
    <li><a href="./7444_test.html">7444.test</a>
  
    <li><a href="./9_39_pl.html">9.39.pl</a>
  
    <li><a href="./A_java.html">A.java</a>
  
    <li><a href="./AdvancedPerl_pl.html">AdvancedPerl.pl</a>
  
    <li><a href="./ArrayDemo_java.html">ArrayDemo.java</a>
  
    <li><a href="./Devinitive_js.html">Devinitive.js</a>
  
    <li><a href="./EffectivePerl_pl.html">EffectivePerl.pl</a>
  
    <li><a href="./EmergencyElisp_txt.html">EmergencyElisp</a>
  
    <li><a href="./LiveLessons_pl.html">LiveLessons.pl</a>
  
    <li><a href="./LiveLessons_py.html">LiveLessons.py</a>
  
    <li><a href="./PERL_vim.html">PERL.vim</a>
  
    <li><a href="./Scheme_txt.html">Scheme</a>
  
    <li><a href="./a_clj.html">a.clj</a>
  
    <li><a href="./a_cs.html">a.cs</a>
  
    <li><a href="./a_hs.html">a.hs</a>
  
    <li><a href="./a_html.html">a.html</a>
  
    <li><a href="./a_js.html">a.js</a>
  
    <li><a href="./a_lisp.html">a.lisp</a>
  
    <li><a href="./a_pl.html">a.pl</a>
  
    <li><a href="./a_ps1.html">a.ps1</a>
  
    <li><a href="./a_py.html">a.py</a>
  
    <li><a href="./a_red.html">a.red</a>
  
    <li><a href="./a_scala.html">a.scala</a>
  
    <li><a href="./a_sml.html">a.sml</a>
  
    <li><a href="./a_vbs.html">a.vbs</a>
  
    <li><a href="./a_vim.html">a.vim</a>
  
    <li><a href="./b_js.html">b.js</a>
  
    <li><a href="./b_p6.html">b.p6</a>
  
    <li><a href="./b_pl.html">b.pl</a>
  
    <li><a href="./b_py.html">b.py</a>
  
    <li><a href="./bigpy-dir_py.html">bigpy-dir.py</a>
  
    <li><a href="./c_js.html">c.js</a>
  
    <li><a href="./c_pl.html">c.pl</a>
  
    <li><a href="./chinese_red.html">chinese.red</a>
  
    <li><a href="./client_pl.html">client.pl</a>
  
    <li><a href="./closureobject_txt.html">closureobject</a>
  
    <li><a href="./connect_py.html">connect.py</a>
  
    <li><a href="./connect2_py.html">connect2.py</a>
  
    <li><a href="./connect3_py.html">connect3.py</a>
  
    <li><a href="./cron_pl.html">cron.pl</a>
  
    <li><a href="./cronlog_txt.html">cronlog</a>
  
    <li><a href="./crontab.html">crontab</a>
  
    <li><a href="./d_pl.html">d.pl</a>
  
    <li><a href="./download_py.html">download.py</a>
  
    <li><a href="./fact_py.html">fact.py</a>
  
    <li><a href="./fork_pl.html">fork.pl</a>
  
    <li><a href="./gopherclient_py.html">gopherclient.py</a>
  
    <li><a href="./gopherclient3_py.html">gopherclient3.py</a>
  
    <li><a href="./gopherlibclient_py.html">gopherlibclient.py</a>
  
    <li><a href="./hangman_pl.html">hangman.pl</a>
  
    <li><a href="./lgetr_pl.html">lgetr.pl</a>
  
    <li><a href="./markov_pl.html">markov.pl</a>
  
    <li><a href="./mydata.html">mydata</a>
  
    <li><a href="./perlEssential_pl.html">perlEssential.pl</a>
  
    <li><a href="./python-mode_el.html">python-mode.el</a>
  
    <li><a href="./red_red.html">red.red</a>
  
    <li><a href="./repl_vbs.html">repl.vbs</a>
  
    <li><a href="./server_pl.html">server.pl</a>
  
    <li><a href="./server_py.html">server.py</a>
  
    <li><a href="./socketerrors_py.html">socketerrors.py</a>
  
    <li><a href="./t_py.html">t.py</a>
  
    <li><a href="./tags_vim.html">tags.vim</a>
  
    <li><a href="./urlclient_py.html">urlclient.py</a>
  
    <li><a href="./vbs-repl_el.html">vbs-repl.el</a>
  
    <li><a href="./vbsh_vbs.html">vbsh.vbs</a>
  
    <li><a href="./vbshell_vbs.html">vbshell.vbs</a>
  
    <li><a href="./vimtags_pl.html">vimtags.pl</a>
  
    <li><a href="./visual-basic-mode_el.html">visual-basic-mode.el</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page vbs-repl.el">

<p>;;; <a href="vbs-repl_el.html">vbs-repl.el</a> — Support for VBScript programming in Emacs</p>

<p>;;; Copyright: (C) 2009 Charles Sebold ;; ;;     This program is NOT part of GNU Emacs. ;;  ;;     This program is free software; you can redistribute it and/or ;;     modify it under the terms of the GNU General Public License as ;;     published by the Free Software Foundation; either version 2 of ;;     the License, or (at your option) any later version. ;;  </p>

<p>;;     This program is distributed in the hope that it will be useful, ;;     but WITHOUT ANY WARRANTY; without even the implied warranty of ;;     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the ;;     GNU General Public License for more details. ;;  </p>

<p>;;     You should have received a copy of the GNU General Public License ;;     along with GNU Emacs; if not, write to the Free Software ;;     Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA ;;     02110-1301 USA ;; ;; Latest version should be available at: ;;     &lt;URL:<a href="http://www.emacswiki.org/emacs/VbsReplMode">www.emacswiki.org/emacs/VbsReplMode</a>&gt; ;;</p>

<p>;; Filename: <a href="vbs-repl_el.html">vbs-repl.el</a> ;; Description: Support for VBScript programming in Emacs ;; Author: Charles Sebold &lt;csebold at gmail.com&gt; ;; Maintainer: Charles Sebold &lt;csebold at gmail.com&gt; ;; Created: Thu 19 Feb 2009 10:00 ;; Version: 2.1 ;; Last-Updated: Fri 20 Feb 2009 17:01 ;;           By: Charles Sebold ;;     Update #: 1 ;; URL: <a href="http://www.emacswiki.org/emacs/VbsReplMode">www.emacswiki.org/emacs/VbsReplMode</a> ;; Keywords: vbscript, repl, programming, mode ;; Compatibility: GNU Emacs 22+, untested with Emacs21- or XEmacs ;;  ;; Features that might be required by this library: ;; ;;   <a href="visual-basic-mode_el.html">visual-basic-mode.el</a> &lt;<a href="http://www.emacswiki.org/emacs/VisualBasicMode">www.emacswiki.org/emacs/VisualBasicMode</a>&gt;</p>

<p>;;; Commentary: ;;  ;; At this point, there are a few different forks of visual basic modes ;; to choose from, if you want to develop VBScript.  The hard thing ;; about scripting in VBScript (especially if you&#39;re more accustomed to ;; Lispy sorts of languages) is the lack of a REPL ;; (Read-Eval-Print-Loop), a way to try things and see if they work. ;; The aim of this Emacs package is to provide functionality similar to ;; a REPL, although it won&#39;t really be one. ;; ;; The biggest thing holding me back from making this a full-blown REPL ;; is the painful truth that VBScript&#39;s “=” operator is ambiguous by ;; itself; it needs context.  For example, do you want to assign the ;; value 5 to the variable x?  Then you can say “x=5” and there, you ;; have assigned that value.  But how do you test for equality between x ;; and 5?  The same way.  In the context of things like If…Then ;; statements, If x=5 Then… will not assign 5 to x, it will test for ;; equality between x and 5.  Hence, just like the difference between ;; Subs and Functions, there are two ways of evaluating a string into ;; VBScript code: Execute (corresponds to Sub), and Eval (corresponds to ;; Function). ;; ;; For the purposes of this code, by default everything is an Execute. ;; If you want something to be Evaled rather than Executed, run it with ;; the prefix argument.  For example, if I&#39;m sitting with the cursor at ;; the end of a variable assignment, like “x = 5”, with my keybindings ;; I&#39;ll hit C-c C-e to execute that line.  But if I want to know if x = ;; 5, then I&#39;ll use the prefix arg.  In that case, I hit C-u C-c C-e, ;; and I get either “True” or “False” in response. ;; ;; Previous versions of this REPL tried to guess whether you wanted code ;; Evaled or Executed.  That was too problematic; maybe in the future we ;; will do that again, but for now you can guide it to do what you want. ;; ;; New in this version: we have a vbscript-mode now, derived from ;; visual-basic-mode. ;; ;; To use this, put it in your load-path and do something like the ;; following in your .emacs file: ;; ;; ; VBScript editing ;; (setq auto-mode-alist ;;       (append &#39;((“\.\(vbs\|wsf\)$” . vbscript-mode)) ;;               auto-mode-alist)) ;;  ;; To start the repl, load a VBScript file, make sure you&#39;re in ;; visual-basic mode, and hit C-c C-z (or whatever you mapped to ;; vbs-setup-repl).  To execute from the beginning of the line (or the ;; beginning of the statement; it does recognize multiline VBScript), ;; use C-c C-e.  Select a region and execute it with C-c C-r.  If you ;; want it to Eval rather than Execute (like, for example, you want to ;; know what “x &amp; y” would be), Use C-u before the above keystrokes.</p>

<p>;;; History: ;;  ;;  v1.0: implemented a REPL that tried to guess whether you wanted your ;;        code Evaled or Executed ;;  v2.0: new REPL, easier to run without Emacs, now defaults to ;;        Executing everything but you decide when you want it Evaled ;;  v2.1: Implemented `vbscript-mode&#39; derived from visual-basic-mode</p>

<p>;;; Code:</p>

<p>(defvar vbs-repl-script “ReplPrompt = "&gt; " Set ReplFso = CreateObject(&quot;Scripting.FileSystemObject&quot;)</p>

<p>Sub ReplErrprint(errno)</p>

<pre>WScript.StdOut.Write \&quot;Error # \&quot; &amp; CStr(errno.Number) &amp; \&quot; \&quot; &amp; _
    errno.Description</pre>

<p>End Sub</p>

<p>Function ReplWhyMulti(firstLine)</p>

<pre>If Right(firstLine,1) = \&quot;_\&quot; Then
    ReplWhyMulti = \&quot;_\&quot;
Elseif LCase(Left(firstLine,3)) = \&quot;sub\&quot; Then
    ReplWhyMulti = \&quot;Sub\&quot;
Elseif LCase(Left(firstLine,8)) = \&quot;function\&quot; Then
    ReplWhyMulti = \&quot;Function\&quot;
Else
    ReplWhyMulti = \&quot;?\&quot;
End If</pre>

<p>End Function</p>

<p>Function ReplTestEndMulti(lastLine,why)</p>

<pre>lastLine = LTrim(RTrim(lastLine))
If why = \&quot;_\&quot; And Right(lastLine,1) &lt;&gt; \&quot;_\&quot; Then
    ReplTestEndMulti = True
Elseif why = \&quot;Sub\&quot; And LCase(lastLine) = \&quot;end sub\&quot; Then
    ReplTestEndMulti = True
Elseif why = \&quot;Function\&quot; And LCase(lastline) = \&quot;end function\&quot; Then
    ReplTestEndMulti = True
Else
    ReplTestEndMulti = False
End If</pre>

<p>End Function</p>

<p>Function ReplBufferIn(firstLine)</p>

<pre>firstLine = LTrim(RTrim(firstLine))
ReplWhy = ReplWhyMulti(firstLine)
ReplPrompt = ReplWhy &amp; \&quot;&gt; \&quot;
ReplBufferIn = firstLine
Do
    WScript.StdOut.Write ReplPrompt
    nextLine = WScript.StdIn.ReadLine
    ReplBufferIn = ReplBufferIn &amp; vbCRLF &amp; nextLine
Loop Until ReplTestEndMulti(nextLine, ReplWhy)
ReplPrompt = \&quot;&gt; \&quot;</pre>

<p>End Function</p>

<p>While 1:</p>

<pre>WScript.StdOut.Write ReplPrompt
ReplInput = WScript.StdIn.ReadLine
If ReplInput &lt;&gt; \&quot;\&quot; Then
    If ReplWhyMulti(ReplInput) &lt;&gt; \&quot;?\&quot; Then
        ReplInput = ReplBufferIn(ReplInput)
        On Error Resume Next
        Execute(ReplInput)
    Else
        ReplInputArgs = Split(LTrim(ReplInput))
        If ReplInputArgs(0) = \&quot;ReplLoad\&quot; Then
            Set ReplFile = ReplFso.OpenTextFile(ReplInputArgs(1), 1)
            ReplInput = \&quot;\&quot;
            Do While ReplFile.AtEndOfStream &lt;&gt; True
                ReplThisLine = ReplFile.ReadLine
                ReplInput = ReplInput &amp; ReplThisLine &amp; vbCRLF
            Loop
            ReplFile.Close()
            On Error Resume Next
            Execute(ReplInput)
        Elseif ReplInputArgs(0) = \&quot;ReplLoadEval\&quot; Then
            Set ReplFile = ReplFso.OpenTextFile(ReplInputArgs(1), 1)
            ReplInput = \&quot;\&quot;
            Do While ReplFile.AtEndOfStream &lt;&gt; True
                ReplThisLine = ReplFile.ReadLine
                ReplInput = ReplInput &amp; ReplThisLine &amp; vbCRLF
            Loop
            ReplFile.Close()
            On Error Resume Next
            WScript.StdOut.Write Eval(ReplInput) &amp; vbCRLF
        Elseif ReplInputArgs(0) = \&quot;ReplEval\&quot; Then
            On Error Resume Next
            WScript.StdOut.Write Eval(Right(ReplInput,Len(ReplInput)-9)) &amp; _
                   vbCRLF
        Else
            On Error Resume Next
            Execute(ReplInput)
        End If
    End If
    If Err.Number &lt;&gt; 0 Then
        ReplErrprint(Err)
        WScript.StdOut.Write vbCRLF
        Err.Clear
    End If
End If
On Error GoTo 0</pre>

<p>Wend “)</p>

<p>(defun vbs-run-repl ()</p>

<pre>&quot;Deletes all tempfiles and run a new REPL.&quot;
(interactive)
(dolist (i (directory-files temporary-file-directory t
                            &quot;vbsrepl.*\\.vbs&quot;))
  (delete-file i))
(let ((tempfile (make-temp-file &quot;vbsrepl&quot; nil &quot;.vbs&quot;)))
  (with-temp-file tempfile
    (insert vbs-repl-script))
  (make-comint &quot;VBScript&quot; &quot;cscript&quot; nil tempfile)))</pre>

<p>(defun vbs-setup-repl ()</p>

<pre>&quot;Set up a REPL in the opposite window, restarting it if necessary.&quot;
(interactive)
(delete-other-windows)
(if (&gt; (frame-parameter nil &#39;width) 160)
    (split-window-horizontally)
  (split-window-vertically))
(other-window 1)
(if (and (get-buffer &quot;*VBScript*&quot;) (get-process &quot;VBScript&quot;))
    (switch-to-buffer &quot;*VBScript*&quot;)
  (vbs-run-repl)
  (switch-to-buffer &quot;*VBScript*&quot;))
(other-window 1))</pre>

<p>(defun vbs-execute-expression (arg evalp)</p>

<pre>&quot;Send expression to REPL and evaluate it.</pre>

<p>Argument ARG is the prefix argument. Argument EVALP is whether to sent this to Eval (nil) or Execute (t).“</p>

<pre>(if evalp
    (if (string-match &quot;\n&quot; arg)
        (let ((tempfile (make-temp-file &quot;vbsrepl&quot; nil &quot;.vbs&quot;)))
          (with-temp-file tempfile
            (insert arg))
          (comint-send-string &quot;*VBScript*&quot;
                              (concat &quot;ReplLoadEval &quot; tempfile &quot;\n&quot;)))
      (comint-send-string &quot;*VBScript*&quot; (concat &quot;ReplEval &quot; arg &quot;\n&quot;)))
  (if (string-match &quot;\n&quot; arg)
      (let ((tempfile (make-temp-file &quot;vbsrepl&quot; nil &quot;.vbs&quot;)))
        (with-temp-file tempfile
          (insert arg))
        (comint-send-string &quot;*VBScript*&quot;
                            (concat &quot;ReplLoad &quot; tempfile &quot;\n&quot;)))
    (comint-send-string &quot;*VBScript*&quot; (concat arg &quot;\n&quot;)))))</pre>

<p>(defun vbs-last-exp (arg)</p>

<pre>&quot;Return last expression in current buffer before ARG.&quot;
(let ((beginning-pt
       (let ((possible (save-excursion
                         (beginning-of-line)
                         (point))))
         (if (= possible (point-min))
             possible
           (save-excursion
             (while
                 (progn
                   (forward-line -1)
                   (beginning-of-line)
                   (and (not (= (point) (point-min)))
                        (looking-at &quot;[^\n]*?_ *\n&quot;))))
             (if (and (= (point) (point-min))
                      (looking-at &quot;[^\n]*?_ *\n&quot;))
                 (point)
               (forward-line 1)
               (point)))))))
  (buffer-substring-no-properties beginning-pt arg)))</pre>

<p>(defun vbs-execute-sub ()</p>

<pre>&quot;When within a Sub or Function definition, Execute it.&quot;
(interactive)
(save-excursion
  (let* ((current (point))
         (end (progn
                (beginning-of-line)
                (re-search-forward &quot;^ *end \\(sub\\|function\\)&quot; nil t)
                (point)))
         (s-or-f (match-string-no-properties 1))
         (start (progn
                  (re-search-backward
                   (concat &quot;^ *&quot; s-or-f &quot; &quot;) nil t)
                  (point))))
    (if (&gt; start current)
        (message &quot;Not in a sub or function.&quot;)
      (vbs-execute-expression
       (buffer-substring-no-properties start end)
       nil)))))</pre>

<p>(defun vbs-execute-region (start end)</p>

<pre>&quot;Send region from START to END to REPL.&quot;
(interactive &quot;r&quot;)
(vbs-execute-expression
 (buffer-substring-no-properties start end)
 current-prefix-arg))</pre>

<p>(defun vbs-execute (arg)</p>

<pre>&quot;Evaluate VBScript expression before point.</pre>

<p>Argument ARG is the prefix arg, add prefix if you want this Evaled rather than Executed.“</p>

<pre>(interactive &quot;P&quot;)
(let ((eval-this (vbs-last-exp (point))))
  (if eval-this
      (vbs-execute-expression eval-this arg)
    (message &quot;Unable to find last expression.&quot;))))</pre>

<p>(require &#39;visual-basic-mode)</p>

<p>;; This is some approximation of the set of reserved words in VBScript. (eval-and-compile</p>

<pre>(defvar vbscript-all-keywords
  &#39;(&quot;Abs&quot; &quot;And&quot; &quot;Array&quot; &quot;Asc&quot; &quot;AscB&quot; &quot;AscW&quot; &quot;Assignments&quot; &quot;Atn&quot;
    &quot;CBool&quot; &quot;CByte&quot; &quot;CCur&quot; &quot;CDate&quot; &quot;CDbl&quot; &quot;CInt&quot; &quot;CLng&quot; &quot;CSng&quot; &quot;CStr&quot;
    &quot;Call&quot; &quot;Case&quot; &quot;Chr&quot; &quot;ChrB&quot; &quot;ChrW&quot; &quot;Cint&quot; &quot;Class&quot; &quot;Clear&quot; &quot;Const&quot;
    &quot;Conversions&quot; &quot;Cos&quot; &quot;CreateObject&quot; &quot;Date&quot; &quot;DateAdd&quot; &quot;DateDiff&quot;
    &quot;DatePart&quot; &quot;DateSerial&quot; &quot;DateValue&quot; &quot;Day&quot; &quot;Derived&quot; &quot;Description&quot;
    &quot;Dim&quot; &quot;Do&quot; &quot;Each&quot; &quot;Else&quot; &quot;ElseIf&quot; &quot;Empty&quot; &quot;End&quot; &quot;Eqv&quot; &quot;Erase&quot; &quot;Err&quot;
    &quot;Error&quot; &quot;Eval&quot; &quot;Execute&quot; &quot;ExecuteGlobal&quot; &quot;Exit&quot; &quot;Exp&quot; &quot;Explicit&quot;
    &quot;False&quot; &quot;Filter&quot; &quot;FirstIndex&quot; &quot;Fix&quot; &quot;Fixs&quot; &quot;For&quot; &quot;FormatCurrency&quot;
    &quot;FormatDateTime&quot; &quot;FormatNumber&quot; &quot;FormatPercent&quot; &quot;Function&quot; &quot;GetLocale&quot;
    &quot;GetObject&quot; &quot;GetRef&quot; &quot;Global&quot; &quot;HelpContext&quot; &quot;HelpFile&quot; &quot;Hex&quot; &quot;Hour&quot;
    &quot;If&quot; &quot;IgnoreCase&quot; &quot;Imp&quot; &quot;InStr&quot; &quot;InStrB&quot; &quot;InStrRev&quot; &quot;InputBox&quot; &quot;Instr&quot;
    &quot;Int&quot; &quot;Int,&quot; &quot;Is&quot; &quot;IsArray&quot; &quot;IsArray &quot; &quot;IsDate&quot; &quot;IsEmpty&quot; &quot;IsNull&quot;
    &quot;IsNumeric&quot; &quot;IsObject&quot; &quot;Join&quot; &quot;LBound&quot; &quot;LCase&quot; &quot;LTrim&quot; &quot;Lcase&quot; &quot;Left&quot;
    &quot;LeftB&quot; &quot;Len&quot; &quot;LenB&quot; &quot;Length&quot; &quot;Let&quot; &quot;LoadPicture&quot; &quot;Log&quot; &quot;Loop&quot; &quot;Ltrim&quot;
    &quot;Match&quot; &quot;Math&quot; &quot;Maths&quot; &quot;Mid&quot; &quot;MidB&quot; &quot;Minute&quot; &quot;Mod&quot; &quot;Month&quot; &quot;MonthName&quot;
    &quot;MsgBox&quot; &quot;New&quot; &quot;Next&quot; &quot;Not&quot; &quot;Nothing&quot; &quot;Now&quot; &quot;Null&quot; &quot;Number&quot; &quot;Oct&quot; &quot;On&quot;
    &quot;Option&quot; &quot;Or&quot; &quot;Pattern&quot; &quot;Private&quot; &quot;Procedures&quot; &quot;Public&quot; &quot;RGB&quot; &quot;RTrim&quot;
    &quot;Raise&quot; &quot;Randomize&quot; &quot;ReDim&quot; &quot;Rem&quot; &quot;Replace&quot; &quot;Right&quot; &quot;RightB&quot; &quot;Rnd&quot;
    &quot;Round&quot; &quot;Rtrim&quot; &quot;ScriptEngine&quot; &quot;ScriptEngineBuildVersion&quot;
    &quot;ScriptEngineMajorVersion&quot; &quot;ScriptEngineMinorVersion&quot; &quot;Second&quot;
    &quot;Select&quot; &quot;Set&quot; &quot;SetLocale&quot; &quot;Sgn&quot; &quot;Sin&quot; &quot;Source&quot; &quot;Space&quot; &quot;Split&quot; &quot;Sqr&quot;
    &quot;StrComp&quot; &quot;String&quot; &quot;Strings&quot; &quot;Sub&quot; &quot;SubMatches&quot; &quot;Tan&quot; &quot;Test&quot; &quot;Then&quot;
    &quot;Time&quot; &quot;TimeSerial&quot; &quot;TimeValue&quot; &quot;Timer&quot; &quot;Trim&quot; &quot;Trims&quot; &quot;True&quot;
    &quot;TypeName&quot; &quot;UBound&quot; &quot;UCase&quot; &quot;Ucase&quot; &quot;Until&quot; &quot;Value&quot; &quot;VarType&quot;
    &quot;Variants&quot; &quot;VbCrLf&quot; &quot;Weekday&quot; &quot;WeekdayName&quot; &quot;Wend&quot; &quot;While&quot; &quot;With&quot;
    &quot;Xor&quot; &quot;Year&quot; &quot;vbAbort&quot; &quot;vbAbortRetryIgnore&quot; &quot;vbApplicationModal&quot;
    &quot;vbArray&quot; &quot;vbBinaryCompare&quot; &quot;vbBlack&quot; &quot;vbBlue&quot; &quot;vbBoolean&quot; &quot;vbByte&quot;
    &quot;vbCancel&quot; &quot;vbCr&quot; &quot;vbCritical&quot; &quot;vbCurrency&quot; &quot;vbCyan&quot; &quot;vbDataObject&quot;
    &quot;vbDate&quot; &quot;vbDecimal&quot; &quot;vbDefaultButton1&quot; &quot;vbDefaultButton2&quot;
    &quot;vbDefaultButton3&quot; &quot;vbDefaultButton4&quot; &quot;vbEmpty&quot; &quot;vbError&quot;
    &quot;vbExclamation&quot; &quot;vbFalse&quot; &quot;vbFirstFourDays&quot; &quot;vbFirstFullWeek&quot;
    &quot;vbFirstJan1&quot; &quot;vbFormFeed&quot; &quot;vbFriday&quot; &quot;vbGeneralDate&quot; &quot;vbGreen&quot;
    &quot;vbIgnore&quot; &quot;vbInformation&quot; &quot;vbInteger&quot; &quot;vbLf&quot; &quot;vbLong&quot; &quot;vbLongDate&quot;
    &quot;vbLongTime&quot; &quot;vbMagenta&quot; &quot;vbMonday&quot; &quot;vbNewLine&quot; &quot;vbNo&quot; &quot;vbNull&quot;
    &quot;vbNullChar&quot; &quot;vbNullString&quot; &quot;vbOK&quot; &quot;vbOKCancel&quot; &quot;vbOKOnly&quot; &quot;vbObject&quot;
    &quot;vbObjectError&quot; &quot;vbQuestion&quot; &quot;vbRed&quot; &quot;vbRetry&quot; &quot;vbRetryCancel&quot;
    &quot;vbSaturday&quot; &quot;vbShortDate&quot; &quot;vbShortTime&quot; &quot;vbSingle&quot; &quot;vbString&quot;
    &quot;vbSunday&quot; &quot;vbSystemModal&quot; &quot;vbTab&quot; &quot;vbTextCompare&quot; &quot;vbThursday&quot;
    &quot;vbTrue&quot; &quot;vbTuesday&quot; &quot;vbUseDefault&quot; &quot;vbUseSystemDayOfWeek&quot; &quot;vbVariant&quot;
    &quot;vbVerticalTab&quot; &quot;vbWednesday&quot; &quot;vbWhite&quot; &quot;vbYellow&quot; &quot;vbYes&quot; &quot;vbYesNo&quot;
    &quot;vbYesNoCancel&quot;)))</pre>

<p>(defvar vbscript-font-lock-keywords-1</p>

<pre>(eval-when-compile
  (list
   ;; Names of functions.
   (list visual-basic-defun-start-regexp
         &#39;(1 font-lock-keyword-face nil t)
         &#39;(2 font-lock-keyword-face nil t)
         &#39;(3 font-lock-function-name-face))

   ;; Statement labels
   (cons visual-basic-label-regexp &#39;font-lock-keyword-face)

   ;; Case values
   ;; String-valued cases get font-lock-string-face regardless.
   (list &quot;^[ \t]*case[ \t]+\\([^&#39;\n]+\\)&quot; 1 &#39;font-lock-keyword-face t)

   ;; Any keywords you like.
   (list (regexp-opt
          &#39;(&quot;Dim&quot; &quot;If&quot; &quot;Then&quot; &quot;Else&quot; &quot;ElseIf&quot; &quot;End If&quot;) &#39;words)
         1 &#39;font-lock-keyword-face))))</pre>

<p>(defvar vbscript-font-lock-keywords-2</p>

<pre>(append vbscript-font-lock-keywords-1
        (eval-when-compile
          `((, (regexp-opt vbscript-all-keywords &#39;words)
                 1 font-lock-keyword-face)))))</pre>

<p>(defvar vbscript-font-lock-keywords vbscript-font-lock-keywords-1)</p>

<p>(define-derived-mode vbscript-mode visual-basic-mode “VBScript”</p>

<pre>&quot;Major mode for VBScript.</pre>

<p>\{vbscript-mode-map}“</p>

<pre>(make-local-variable &#39;font-lock-defaults)
(setq font-lock-defaults
      `((vbscript-font-lock-keywords
         vbscript-font-lock-keywords-1
         vbscript-font-lock-keywords-2)
        nil t ((,(string-to-char &quot;_&quot;) . &quot;w&quot;)))))</pre>

<p>(define-key vbscript-mode-map “C-cC-z” &#39;vbs-setup-repl) (define-key vbscript-mode-map “C-cC-e” &#39;vbs-execute) (define-key vbscript-mode-map “C-cC-r” &#39;vbs-execute-region) (define-key vbscript-mode-map “C-M-x” &#39;vbs-execute-sub)</p>

<p>(provide &#39;vbs-repl) (provide &#39;vbs-repl)</p>

<p>;;; <a href="vbs-repl_el.html">vbs-repl.el</a> ends here</p>

</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.1.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

